<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="admin/mainTemplate">
<head>
</head>
<body>
<section layout:fragment="content">
        <form th:action="@{/admin/contracts}" th:object="${contract}" method="post">
          <input type="hidden" th:field="*{id}" />
          <input type="hidden" th:field="*{order}"/>
          <div class="form-group">
            <a th:href="@{/admin/orders/{id}(id=${contract.order.id})}"
               th:text="'Order: ' + ${contract.order.service.name} + ' from ' + ${contract.order.openDate}" ></a>
            <br/>
            <br/>
            <br/>
            <label th:for="${#ids.next('contractDate')}">Contract Date</label>
            <input type="date" th:field="*{contractDate}" class="form-control"/><br/>
          </div>
          <div class="form-group">
            <label th:for="${#ids.next('paymentType')}">Payment type</label>
            <select th:field = "*{paymentType}" class="form-control">
              <option value="">Select payment type</option>
              <option th:each="paymentTypeValue : ${T(ua.com.foxminded.accountingsystem.model.PaymentType).values()}"
                      th:value="${paymentTypeValue}"
                      th:text="${paymentTypeValue}"/>
            </select>
            <output th:if="${#fields.hasErrors('paymentType')}" th:errors="*{paymentType}" class="text-danger">Payment Type
              Error
            </output>
          </div>
          <div class="form-group">
            <label th:for="${#ids.next('openDate')}">Date of opening contract</label>
            <input type="date" th:field="*{openDate}" class="form-control"/><br/>
            <label th:for="${#ids.next('paymentDate')}">Payment date</label>
            <input type="date" th:field="*{paymentDate}" class="form-control"/><br/>
            <label th:for="${#ids.next('price')}">Price</label>
            <div th:id="price">
              <div class="col-sm-8">
                <input th:value="*{price.price > 0} ? *{price.price}"
                       th:id="*{'price.price'}" th:name="*{'price.price'}"
                       type="number" class="form-control" required="required" min="0" max="2147483647"/>
                <input type="hidden" th:field="*{price.id}"/>
              </div>
              <div class="col-sm-4">
                <select th:field="*{price.currency}" class="form-control">
                  <option th:each="currencyTypeValue : ${T(ua.com.foxminded.accountingsystem.model.Currency).values()}"
                          th:value="${currencyTypeValue}"
                          th:text="${currencyTypeValue}"/>
                </select>
              </div>
            </div>
            <output th:if="${#fields.hasErrors('price')}" th:errors="${contract.price}" class="text-danger">Price
              Error
            </output>
          </div>
          <div class="form-group">
            <label th:for="${#ids.next('employee')}">Employee</label>
            <select th:field="*{employee}" class="form-control">
              <option value="">Select Employee</option>
              <option th:each="employee : ${employees}"
                      th:value="${employee.id}"
                      th:text="${employee.firstName} + ' ' + ${employee.lastName}">
              </option>
            </select>
            <output th:if="${#fields.hasErrors('employee')}" th:errors="*{employee}" class="text-danger">Employee
              Error
            </output>
            <label th:for="${#ids.next('employeeRate.price')}"
                   th:text="'Employee rate '+*{employeeRate.currency}+' *'"></label>
            <output th:if="${#fields.hasErrors('employeeRate.price')}" th:errors="*{employeeRate.price}"
                    class="text-danger">Employee rate error
            </output>
            <input th:value="*{employeeRate.price > 0} ? *{employeeRate.price}"
                   th:id="*{'employeeRate.price'}" th:name="*{'employeeRate.price'}"
                   type="number" class="form-control" required="required" min="0" max="2147483647"/>
            <input type="hidden" th:field="*{employeeRate.id}"/>
            <input type="hidden" th:field="*{employeeRate.currency}"/>
          </div>
          <div class="form-group">
            <label th:for="${#ids.next('closeDate')}">Date of closing contract</label>
            <input type="date" th:field="*{closeDate}" class="form-control"/><br/>
            <label th:for="${#ids.next('closeType')}">Close type</label>
            <select th:field = "*{closeType}" class="form-control">
              <option value="">Close contract (select type of closing)</option>
              <option th:each="closeTypeValue : ${T(ua.com.foxminded.accountingsystem.model.CloseType).values()}"
                      th:value="${closeTypeValue}"
                      th:text="${closeTypeValue}"/>
            </select>
          </div>
          <button type="submit" class="btn btn-primary">Save</button>
        </form>
        <form th:action="@{/admin/contracts/{id}(id=${contract.id})}" th:method="delete">
          <button type="submit" class="btn btn-danger">Delete</button>
        </form>
        <a th:href="@{/admin/contracts}" class="btn btn-primary" >Exit</a>
</section>
</body>
</html>
