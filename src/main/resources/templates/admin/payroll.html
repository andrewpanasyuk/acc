<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="admin/mainTemplate">
<head>
  <object th:include="admin/fragments/head :: bootstrap_table" th:remove="tag"/>
</head>
<body>
<section layout:fragment="content">

  <div class="row" id="payroll-form">
    <div class="col-md-10 col-sm-6 col-xs-12">
      <div class="panel panel-default">
        <div class="panel-heading clearfix">
          <i class="icon-calendar"></i>
          <h3 class="panel-title">Choose range to calculate salary</h3>
        </div>
        <div class="panel-body">
          <form class="form-horizontal row-border" th:action="@{/admin/salary/payroll}" method="get">
            <div class="form-group">
              <label class="col-md-2 control-label">Date from</label>
              <div class="col-md-10">
                <input class="form-control datepicker" data-provide="datepicker" name="dateFrom" th:value="${#temporals.format(dateFrom, 'dd-MM-yyyy')}"/>
              </div>
            </div>
            <div class="form-group">
              <label class="col-md-2 control-label">Date to</label>
              <div class="col-md-10">
                <input class="form-control datepicker" data-provide="datepicker" name="dateTo" th:value="${#temporals.format(dateTo, 'dd-MM-yyyy')}"/>
              </div>
            </div>
            <button type="submit" class="btn btn-primary pull-right">Calculate salaries</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-10 display-grid" th:if="${salaries} != null">
    <table data-toggle="table" data-class="table table-striped table-hover"
           data-pagination="true" data-side-pagination="client" data-search="true" data-show-refresh="true">
      <thead>
      <tr>
        <th>Employee name</th>
        <th>Number of salary items</th>
        <th>Total amount, UAH</th>
        <th>Form</th>
      </tr>
      </thead>
      <tbody>
      <!--/*@thymesVar id="salary" type="ua.com.foxminded.accountingsystem.model.Salary"*/-->
      <tr th:each="salary : ${salaries}">
        <td th:text="${salary.employee.firstName} + ' ' + ${salary.employee.lastName}"></td>
        <td th:text="${salary.salaryItems.size()}"></td>
        <td th:text="${salary.totalAmount.amount} + ', UAH'"></td>
        <td>
          <form th:action="@{/admin/salary/payroll}" th:object="${salary}" method="post">
            <input type="hidden" name="salaryDate" th:value="${salary.salaryDate}"/>
            <input type="hidden" name="dateFrom" th:value="${salary.dateFrom}"/>
            <input type="hidden" name="dateTo" th:value="${salary.dateTo}"/>
            <input type="hidden" name="employee.id" th:value="${salary.employee.id}"/>
            <input type="hidden" name="totalAmount" th:value="${salary.totalAmount}"/>

            <div th:each="salaryItem,stat : ${salary.salaryItems}" class="form-group">
              <input type="hidden" th:value="*{salaryItems[__${stat.index}__].id}"
                     th:name="|salaryItems[${stat.index}].id|"/>
            </div>

            <button id="submit" class="btn btn-primary" style="height:40px;width:80px">Form</button>
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
  <script th:inline="javascript">
    /*<![CDATA[*/
    $('.datepicker').datepicker({
      format: "dd-mm-yyyy",
      todayBtn: "linked",
      clearBtn: true,
      language: "ru",
      calendarWeeks: true,
      autoclose: true,
      todayHighlight: true,
      weekStart: 1
    });
    /*]]>*/
  </script>
</section>
</body>
</html>
